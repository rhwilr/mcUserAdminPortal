var app = angular.module('mcUAP', [
    'ngResource',
    'ui.bootstrap',
    'ui.router.tabs',
    'ui.router',
    'cgBusy'
    ])


    .config(["$interpolateProvider", function ($interpolateProvider) {
        $interpolateProvider.startSymbol('[[');
        $interpolateProvider.endSymbol(']]');
    }])
    .value('cgBusyDefaults',{
        message:'Loading Data',
        backdrop: false,
        templateUrl: '/partials/common/angular-busy.html',
        delay: 0,
        minDuration: 100,
        wrapperClass: 'my-class my-class2'
    });
app.factory('ServersApi', ["$resource", function($resource){
    return $resource('/api/v1/server/:id', {id:'@id'},
        {
            'update': { method:'PUT' }
        });
    }]);
app.factory('UserApi', ["$resource", function($resource){
    return $resource('/api/v1/user/:id', {id:'@id'},
        {
            'updateProfile': { method:'PUT' },
            'updatePassword': { method:'PUT' },
            'updateMinecraft': { method:'PUT' },
            'me': {
                method:'GET',
                url: "/api/v1/user/me"
            },
            'meUpdateProfile': {
                method:'PUT',
                url: "/api/v1/user/me/profile"
            },
            'meUpdatePassword': {
                method:'PUT',
                url: "/api/v1/user/me/password"
            },
            'meUpdateMinecraft': {
                method:'PUT',
                url: "/api/v1/user/me/minecraft"
            }
        });
    }]);
app.controller('ModalInstanceCtrl', ["$scope", "$modalInstance", "ResourcesApi", "recordID", function ($scope, $modalInstance, ResourcesApi, recordID) {

    if (recordID) {
        $scope.myPromise =  ResourcesApi.get({id:recordID}, function(data) {
            $scope.resource = data.data;
            $scope.showModalContent = true;
        });
    }
    else {
        $scope.showModalContent = true;
    }

    $scope.ok = function () {
        if(recordID){
            ResourcesApi.update({ id:$scope.resource.id }, $scope.resource, function(res) {
                $modalInstance.close($scope.resource);
            }, function(res) {
                $scope.errorResponse = res.data.error.message;
            });
        } else {
            console.log("2");
            ResourcesApi.save( $scope.resource, function(res) {
                $modalInstance.close($scope.resource);
            }, function(res) {
                $scope.errorResponse = res.data.error.message;
            });
        }

    };

    $scope.cancel = function () {
        $modalInstance.dismiss('cancel');
    };
}]);
app.controller("AdminCtrl", ["$scope", function($scope) {

    $scope.tabData   = [
        {
            heading: 'Servers',
            route:   'servers'
        },
        {
            heading: 'Subscriptions',
            route:   'subscriptions'
        },
        {
            heading: 'Users',
            route:   'users'
        },
        {
            heading: 'Roles',
            route:   'roles'
        }
    ];


}]).config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {
    //
    // For any unmatched url, redirect to /state1
    $urlRouterProvider.otherwise("/servers");
    //
    // Now set up the states
    $stateProvider.state('servers', {
        url: '/servers',
        templateUrl: '/partials/admin/servers.html'
    }).state('subscriptions', {
        url: '/subscriptions',
        templateUrl: '/partials/admin/subscriptions.html'
    }).state('users', {
        url: '/users',
        templateUrl: '/partials/admin/users.html'
    }).state('roles', {
        url: '/roles',
        templateUrl: '/partials/admin/roles.html'
    });

}]);
app.controller("ServerIndexCtrl", ["$scope", "$modal", "$filter", "ServersApi", function($scope, $modal, $filter, ServersApi) {


    var refreshData = function () {
        $scope.myPromise = ServersApi.get(function(data) {
            $scope.servers = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.open = function (serverEditID) {
        var modalInstance = $modal.open({
            templateUrl: 'AddServerModal.html',
            controller: 'ModalInstanceCtrl',
            resolve: {
                ResourcesApi: function () {
                    return  ServersApi;
                },
                recordID: function () {
                    return  serverEditID;
                }
            }
        });

        modalInstance.result.then(function (data) {
            refreshData();
        }, function () {
        });
    };

}]);
app.controller("MinecraftIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.me(function(data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.saveMinecraft = function () {
        UserApi.meUpdateMinecraft($scope.resource, function(res) {
            $scope.successMinecraftResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };


}]);
app.controller("ProfileCtrl", ["$scope", function($scope) {

    $scope.tabData   = [
        {
            heading: 'Profile',
            route:   'profile'
        },
        {
            heading: 'Minecraft',
            route:   'minecraft'
        }
    ];


}]).config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {
    //
    // For any unmatched url, redirect to /state1
    $urlRouterProvider.otherwise("/profile");
    //
    // Now set up the states
    $stateProvider.state('profile', {
        url: '/profile',
        templateUrl: '/partials/profile/profile.html'
    }).state('minecraft', {
        url: '/minecraft',
        templateUrl: '/partials/profile/minecraft.html'
    });

}]);
app.controller("ProfileIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.me(function(data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.saveProfile = function () {
        UserApi.meUpdateProfile($scope.resource, function(res) {
            $scope.successProfileResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };

    $scope.savePassword = function () {
        UserApi.meUpdatePassword($scope.resource, function(res) {
            $scope.successPasswordResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };


}]);
app.controller('NavbarInstanceCtrl', ["$scope", function ($scope) {
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIlNlcnZpY2VzL1NlcnZlclNlcnZpY2UuanMiLCJTZXJ2aWNlcy9Vc2VyU2VydmljZS5qcyIsIkNvbnRyb2xsZXJzL0NvbW1vbi9Nb2RhbHNDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvQWRtaW5pc3RyYXRpb24vQWRtaW5pc3RyYXRpb25Db250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvQWRtaW5pc3RyYXRpb24vU2VydmVyQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1Byb2ZpbGUvTWluZWNyYWZ0SW5kZXhDdHJsLmpzIiwiQ29udHJvbGxlcnMvUHJvZmlsZS9Qcm9maWxlQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1Byb2ZpbGUvUHJvZmlsZUluZGV4Q3RybC5qcyIsIkNvbnRyb2xsZXJzL1JlZ2lvbnMvTmF2YmFyQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFBLE1BQUEsUUFBQSxPQUFBLFNBQUE7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBOzs7O0tBSUEsZ0NBQUEsVUFBQSxzQkFBQTtRQUNBLHFCQUFBLFlBQUE7UUFDQSxxQkFBQSxVQUFBOztLQUVBLE1BQUEsaUJBQUE7UUFDQSxRQUFBO1FBQ0EsVUFBQTtRQUNBLGFBQUE7UUFDQSxPQUFBO1FBQ0EsYUFBQTtRQUNBLGNBQUE7O0FDbkJBLElBQUEsUUFBQSw0QkFBQSxTQUFBLFVBQUE7SUFDQSxPQUFBLFVBQUEsc0JBQUEsQ0FBQSxHQUFBO1FBQ0E7WUFDQSxVQUFBLEVBQUEsT0FBQTs7O0FDSEEsSUFBQSxRQUFBLHlCQUFBLFNBQUEsVUFBQTtJQUNBLE9BQUEsVUFBQSxvQkFBQSxDQUFBLEdBQUE7UUFDQTtZQUNBLGlCQUFBLEVBQUEsT0FBQTtZQUNBLGtCQUFBLEVBQUEsT0FBQTtZQUNBLG1CQUFBLEVBQUEsT0FBQTtZQUNBLE1BQUE7Z0JBQ0EsT0FBQTtnQkFDQSxLQUFBOztZQUVBLG1CQUFBO2dCQUNBLE9BQUE7Z0JBQ0EsS0FBQTs7WUFFQSxvQkFBQTtnQkFDQSxPQUFBO2dCQUNBLEtBQUE7O1lBRUEscUJBQUE7Z0JBQ0EsT0FBQTtnQkFDQSxLQUFBOzs7O0FDcEJBLElBQUEsV0FBQSw4RUFBQSxVQUFBLFFBQUEsZ0JBQUEsY0FBQSxVQUFBOztJQUVBLElBQUEsVUFBQTtRQUNBLE9BQUEsYUFBQSxhQUFBLElBQUEsQ0FBQSxHQUFBLFdBQUEsU0FBQSxNQUFBO1lBQ0EsT0FBQSxXQUFBLEtBQUE7WUFDQSxPQUFBLG1CQUFBOzs7U0FHQTtRQUNBLE9BQUEsbUJBQUE7OztJQUdBLE9BQUEsS0FBQSxZQUFBO1FBQ0EsR0FBQSxTQUFBO1lBQ0EsYUFBQSxPQUFBLEVBQUEsR0FBQSxPQUFBLFNBQUEsTUFBQSxPQUFBLFVBQUEsU0FBQSxLQUFBO2dCQUNBLGVBQUEsTUFBQSxPQUFBO2VBQ0EsU0FBQSxLQUFBO2dCQUNBLE9BQUEsZ0JBQUEsSUFBQSxLQUFBLE1BQUE7O2VBRUE7WUFDQSxRQUFBLElBQUE7WUFDQSxhQUFBLE1BQUEsT0FBQSxVQUFBLFNBQUEsS0FBQTtnQkFDQSxlQUFBLE1BQUEsT0FBQTtlQUNBLFNBQUEsS0FBQTtnQkFDQSxPQUFBLGdCQUFBLElBQUEsS0FBQSxNQUFBOzs7Ozs7SUFNQSxPQUFBLFNBQUEsWUFBQTtRQUNBLGVBQUEsUUFBQTs7O0FDL0JBLElBQUEsV0FBQSx3QkFBQSxTQUFBLFFBQUE7O0lBRUEsT0FBQSxZQUFBO1FBQ0E7WUFDQSxTQUFBO1lBQ0EsU0FBQTs7UUFFQTtZQUNBLFNBQUE7WUFDQSxTQUFBOztRQUVBO1lBQ0EsU0FBQTtZQUNBLFNBQUE7O1FBRUE7WUFDQSxTQUFBO1lBQ0EsU0FBQTs7Ozs7SUFLQSxnREFBQSxTQUFBLGdCQUFBLG9CQUFBOzs7SUFHQSxtQkFBQSxVQUFBOzs7SUFHQSxlQUFBLE1BQUEsV0FBQTtRQUNBLEtBQUE7UUFDQSxhQUFBO09BQ0EsTUFBQSxpQkFBQTtRQUNBLEtBQUE7UUFDQSxhQUFBO09BQ0EsTUFBQSxTQUFBO1FBQ0EsS0FBQTtRQUNBLGFBQUE7T0FDQSxNQUFBLFNBQUE7UUFDQSxLQUFBO1FBQ0EsYUFBQTs7OztBQ3ZDQSxJQUFBLFdBQUEsaUVBQUEsU0FBQSxRQUFBLFFBQUEsU0FBQSxZQUFBOzs7SUFHQSxJQUFBLGNBQUEsWUFBQTtRQUNBLE9BQUEsWUFBQSxXQUFBLElBQUEsU0FBQSxNQUFBO1lBQ0EsT0FBQSxVQUFBLEtBQUE7WUFDQSxPQUFBLG1CQUFBOzs7SUFHQTs7SUFFQSxPQUFBLE9BQUEsVUFBQSxjQUFBO1FBQ0EsSUFBQSxnQkFBQSxPQUFBLEtBQUE7WUFDQSxhQUFBO1lBQ0EsWUFBQTtZQUNBLFNBQUE7Z0JBQ0EsY0FBQSxZQUFBO29CQUNBLFFBQUE7O2dCQUVBLFVBQUEsWUFBQTtvQkFDQSxRQUFBOzs7OztRQUtBLGNBQUEsT0FBQSxLQUFBLFVBQUEsTUFBQTtZQUNBO1dBQ0EsWUFBQTs7Ozs7QUMzQkEsSUFBQSxXQUFBLGlFQUFBLFNBQUEsUUFBQSxRQUFBLFNBQUEsU0FBQTs7SUFFQSxJQUFBLGNBQUEsWUFBQTtRQUNBLE9BQUEsWUFBQSxRQUFBLEdBQUEsU0FBQSxNQUFBO1lBQ0EsT0FBQSxXQUFBLEtBQUE7WUFDQSxPQUFBLG1CQUFBOzs7SUFHQTs7SUFFQSxPQUFBLGdCQUFBLFlBQUE7UUFDQSxRQUFBLGtCQUFBLE9BQUEsVUFBQSxTQUFBLEtBQUE7WUFDQSxPQUFBLDJCQUFBO1lBQ0EsT0FBQSxnQkFBQTtXQUNBLFNBQUEsS0FBQTtZQUNBLE9BQUEsZ0JBQUEsSUFBQSxLQUFBLE1BQUE7Ozs7OztBQ2ZBLElBQUEsV0FBQSwwQkFBQSxTQUFBLFFBQUE7O0lBRUEsT0FBQSxZQUFBO1FBQ0E7WUFDQSxTQUFBO1lBQ0EsU0FBQTs7UUFFQTtZQUNBLFNBQUE7WUFDQSxTQUFBOzs7OztJQUtBLGdEQUFBLFNBQUEsZ0JBQUEsb0JBQUE7OztJQUdBLG1CQUFBLFVBQUE7OztJQUdBLGVBQUEsTUFBQSxXQUFBO1FBQ0EsS0FBQTtRQUNBLGFBQUE7T0FDQSxNQUFBLGFBQUE7UUFDQSxLQUFBO1FBQ0EsYUFBQTs7OztBQ3pCQSxJQUFBLFdBQUEsK0RBQUEsU0FBQSxRQUFBLFFBQUEsU0FBQSxTQUFBOztJQUVBLElBQUEsY0FBQSxZQUFBO1FBQ0EsT0FBQSxZQUFBLFFBQUEsR0FBQSxTQUFBLE1BQUE7WUFDQSxPQUFBLFdBQUEsS0FBQTtZQUNBLE9BQUEsbUJBQUE7OztJQUdBOztJQUVBLE9BQUEsY0FBQSxZQUFBO1FBQ0EsUUFBQSxnQkFBQSxPQUFBLFVBQUEsU0FBQSxLQUFBO1lBQ0EsT0FBQSx5QkFBQTtZQUNBLE9BQUEsZ0JBQUE7V0FDQSxTQUFBLEtBQUE7WUFDQSxPQUFBLGdCQUFBLElBQUEsS0FBQSxNQUFBOzs7O0lBSUEsT0FBQSxlQUFBLFlBQUE7UUFDQSxRQUFBLGlCQUFBLE9BQUEsVUFBQSxTQUFBLEtBQUE7WUFDQSxPQUFBLDBCQUFBO1lBQ0EsT0FBQSxnQkFBQTtXQUNBLFNBQUEsS0FBQTtZQUNBLE9BQUEsZ0JBQUEsSUFBQSxLQUFBLE1BQUE7Ozs7OztBQ3hCQSxJQUFBLFdBQUEsaUNBQUEsVUFBQSxRQUFBO2VBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbWNVQVAnLCBbXHJcbiAgICAnbmdSZXNvdXJjZScsXHJcbiAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICd1aS5yb3V0ZXIudGFicycsXHJcbiAgICAndWkucm91dGVyJyxcclxuICAgICdjZ0J1c3knXHJcbiAgICBdKVxyXG5cclxuXHJcbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkaW50ZXJwb2xhdGVQcm92aWRlcikge1xyXG4gICAgICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLnN0YXJ0U3ltYm9sKCdbWycpO1xyXG4gICAgICAgICRpbnRlcnBvbGF0ZVByb3ZpZGVyLmVuZFN5bWJvbCgnXV0nKTtcclxuICAgIH0pXHJcbiAgICAudmFsdWUoJ2NnQnVzeURlZmF1bHRzJyx7XHJcbiAgICAgICAgbWVzc2FnZTonTG9hZGluZyBEYXRhJyxcclxuICAgICAgICBiYWNrZHJvcDogZmFsc2UsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvY29tbW9uL2FuZ3VsYXItYnVzeS5odG1sJyxcclxuICAgICAgICBkZWxheTogMCxcclxuICAgICAgICBtaW5EdXJhdGlvbjogMTAwLFxyXG4gICAgICAgIHdyYXBwZXJDbGFzczogJ215LWNsYXNzIG15LWNsYXNzMidcclxuICAgIH0pOyIsImFwcC5mYWN0b3J5KCdTZXJ2ZXJzQXBpJywgZnVuY3Rpb24oJHJlc291cmNlKXtcclxuICAgIHJldHVybiAkcmVzb3VyY2UoJy9hcGkvdjEvc2VydmVyLzppZCcsIHtpZDonQGlkJ30sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAndXBkYXRlJzogeyBtZXRob2Q6J1BVVCcgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7IiwiYXBwLmZhY3RvcnkoJ1VzZXJBcGknLCBmdW5jdGlvbigkcmVzb3VyY2Upe1xyXG4gICAgcmV0dXJuICRyZXNvdXJjZSgnL2FwaS92MS91c2VyLzppZCcsIHtpZDonQGlkJ30sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAndXBkYXRlUHJvZmlsZSc6IHsgbWV0aG9kOidQVVQnIH0sXHJcbiAgICAgICAgICAgICd1cGRhdGVQYXNzd29yZCc6IHsgbWV0aG9kOidQVVQnIH0sXHJcbiAgICAgICAgICAgICd1cGRhdGVNaW5lY3JhZnQnOiB7IG1ldGhvZDonUFVUJyB9LFxyXG4gICAgICAgICAgICAnbWUnOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6J0dFVCcsXHJcbiAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS92MS91c2VyL21lXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ21lVXBkYXRlUHJvZmlsZSc6IHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDonUFVUJyxcclxuICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxL3VzZXIvbWUvcHJvZmlsZVwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdtZVVwZGF0ZVBhc3N3b3JkJzoge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOidQVVQnLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEvdXNlci9tZS9wYXNzd29yZFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdtZVVwZGF0ZU1pbmVjcmFmdCc6IHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDonUFVUJyxcclxuICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxL3VzZXIvbWUvbWluZWNyYWZ0XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7IiwiYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIFJlc291cmNlc0FwaSwgcmVjb3JkSUQpIHtcclxuXHJcbiAgICBpZiAocmVjb3JkSUQpIHtcclxuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gIFJlc291cmNlc0FwaS5nZXQoe2lkOnJlY29yZElEfSwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAkc2NvcGUucmVzb3VyY2UgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93TW9kYWxDb250ZW50ID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgICRzY29wZS5zaG93TW9kYWxDb250ZW50ID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYocmVjb3JkSUQpe1xyXG4gICAgICAgICAgICBSZXNvdXJjZXNBcGkudXBkYXRlKHsgaWQ6JHNjb3BlLnJlc291cmNlLmlkIH0sICRzY29wZS5yZXNvdXJjZSwgZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUucmVzb3VyY2UpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5lcnJvclJlc3BvbnNlID0gcmVzLmRhdGEuZXJyb3IubWVzc2FnZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCIyXCIpO1xyXG4gICAgICAgICAgICBSZXNvdXJjZXNBcGkuc2F2ZSggJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCRzY29wZS5yZXNvdXJjZSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgfTtcclxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJBZG1pbkN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlKSB7XHJcblxyXG4gICAgJHNjb3BlLnRhYkRhdGEgICA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhlYWRpbmc6ICdTZXJ2ZXJzJyxcclxuICAgICAgICAgICAgcm91dGU6ICAgJ3NlcnZlcnMnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhlYWRpbmc6ICdTdWJzY3JpcHRpb25zJyxcclxuICAgICAgICAgICAgcm91dGU6ICAgJ3N1YnNjcmlwdGlvbnMnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhlYWRpbmc6ICdVc2VycycsXHJcbiAgICAgICAgICAgIHJvdXRlOiAgICd1c2VycydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaGVhZGluZzogJ1JvbGVzJyxcclxuICAgICAgICAgICAgcm91dGU6ICAgJ3JvbGVzJ1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG5cclxufSkuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgIC8vXHJcbiAgICAvLyBGb3IgYW55IHVubWF0Y2hlZCB1cmwsIHJlZGlyZWN0IHRvIC9zdGF0ZTFcclxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvc2VydmVyc1wiKTtcclxuICAgIC8vXHJcbiAgICAvLyBOb3cgc2V0IHVwIHRoZSBzdGF0ZXNcclxuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdzZXJ2ZXJzJywge1xyXG4gICAgICAgIHVybDogJy9zZXJ2ZXJzJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9hZG1pbi9zZXJ2ZXJzLmh0bWwnXHJcbiAgICB9KS5zdGF0ZSgnc3Vic2NyaXB0aW9ucycsIHtcclxuICAgICAgICB1cmw6ICcvc3Vic2NyaXB0aW9ucycsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vc3Vic2NyaXB0aW9ucy5odG1sJ1xyXG4gICAgfSkuc3RhdGUoJ3VzZXJzJywge1xyXG4gICAgICAgIHVybDogJy91c2VycycsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vdXNlcnMuaHRtbCdcclxuICAgIH0pLnN0YXRlKCdyb2xlcycsIHtcclxuICAgICAgICB1cmw6ICcvcm9sZXMnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3JvbGVzLmh0bWwnXHJcbiAgICB9KTtcclxuXHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwiU2VydmVySW5kZXhDdHJsXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkZmlsdGVyLCBTZXJ2ZXJzQXBpKSB7XHJcblxyXG5cclxuICAgIHZhciByZWZyZXNoRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gU2VydmVyc0FwaS5nZXQoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuc2VydmVycyA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgJHNjb3BlLnNob3dUYWJsZUNvbnRlbnQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJlZnJlc2hEYXRhKCk7XHJcblxyXG4gICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoc2VydmVyRWRpdElEKSB7XHJcbiAgICAgICAgdmFyIG1vZGFsSW5zdGFuY2UgPSAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnQWRkU2VydmVyTW9kYWwuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNb2RhbEluc3RhbmNlQ3RybCcsXHJcbiAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgIFJlc291cmNlc0FwaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgU2VydmVyc0FwaTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZWNvcmRJRDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgc2VydmVyRWRpdElEO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmVmcmVzaERhdGEoKTtcclxuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJNaW5lY3JhZnRJbmRleEN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWwsICRmaWx0ZXIsIFVzZXJBcGkpIHtcclxuXHJcbiAgICB2YXIgcmVmcmVzaERhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJHNjb3BlLm15UHJvbWlzZSA9IFVzZXJBcGkubWUoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAkc2NvcGUucmVzb3VyY2UgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93VGFibGVDb250ZW50ID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZWZyZXNoRGF0YSgpO1xyXG5cclxuICAgICRzY29wZS5zYXZlTWluZWNyYWZ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFVzZXJBcGkubWVVcGRhdGVNaW5lY3JhZnQoJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NNaW5lY3JhZnRSZXNwb25zZSA9IHJlcztcclxuICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSBudWxsO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JSZXNwb25zZSA9IHJlcy5kYXRhLmVycm9yLm1lc3NhZ2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuXHJcbn0pOyIsImFwcC5jb250cm9sbGVyKFwiUHJvZmlsZUN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlKSB7XHJcblxyXG4gICAgJHNjb3BlLnRhYkRhdGEgICA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhlYWRpbmc6ICdQcm9maWxlJyxcclxuICAgICAgICAgICAgcm91dGU6ICAgJ3Byb2ZpbGUnXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhlYWRpbmc6ICdNaW5lY3JhZnQnLFxyXG4gICAgICAgICAgICByb3V0ZTogICAnbWluZWNyYWZ0J1xyXG4gICAgICAgIH1cclxuICAgIF07XHJcblxyXG5cclxufSkuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgIC8vXHJcbiAgICAvLyBGb3IgYW55IHVubWF0Y2hlZCB1cmwsIHJlZGlyZWN0IHRvIC9zdGF0ZTFcclxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvcHJvZmlsZVwiKTtcclxuICAgIC8vXHJcbiAgICAvLyBOb3cgc2V0IHVwIHRoZSBzdGF0ZXNcclxuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdwcm9maWxlJywge1xyXG4gICAgICAgIHVybDogJy9wcm9maWxlJyxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9wcm9maWxlL3Byb2ZpbGUuaHRtbCdcclxuICAgIH0pLnN0YXRlKCdtaW5lY3JhZnQnLCB7XHJcbiAgICAgICAgdXJsOiAnL21pbmVjcmFmdCcsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvcHJvZmlsZS9taW5lY3JhZnQuaHRtbCdcclxuICAgIH0pO1xyXG5cclxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJQcm9maWxlSW5kZXhDdHJsXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkZmlsdGVyLCBVc2VyQXBpKSB7XHJcblxyXG4gICAgdmFyIHJlZnJlc2hEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRzY29wZS5teVByb21pc2UgPSBVc2VyQXBpLm1lKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnJlc291cmNlID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1RhYmxlQ29udGVudCA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmVmcmVzaERhdGEoKTtcclxuXHJcbiAgICAkc2NvcGUuc2F2ZVByb2ZpbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgVXNlckFwaS5tZVVwZGF0ZVByb2ZpbGUoJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NQcm9maWxlUmVzcG9uc2UgPSByZXM7XHJcbiAgICAgICAgICAgICRzY29wZS5lcnJvclJlc3BvbnNlID0gbnVsbDtcclxuICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2F2ZVBhc3N3b3JkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFVzZXJBcGkubWVVcGRhdGVQYXNzd29yZCgkc2NvcGUucmVzb3VyY2UsIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc1Bhc3N3b3JkUmVzcG9uc2UgPSByZXM7XHJcbiAgICAgICAgICAgICRzY29wZS5lcnJvclJlc3BvbnNlID0gbnVsbDtcclxuICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcblxyXG59KTsiLCJhcHAuY29udHJvbGxlcignTmF2YmFySW5zdGFuY2VDdHJsJywgZnVuY3Rpb24gKCRzY29wZSkge1xyXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=