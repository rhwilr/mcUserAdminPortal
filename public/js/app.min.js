var app = angular.module('mcUAP', [
    'ngResource',
    'ui.bootstrap',
    'ui.router.tabs',
    'ui.router',
    'cgBusy'
    ])


    .config(["$interpolateProvider", function ($interpolateProvider) {
        $interpolateProvider.startSymbol('[[');
        $interpolateProvider.endSymbol(']]');
    }])
    .value('cgBusyDefaults',{
        message:'Loading Data',
        backdrop: false,
        templateUrl: '/partials/common/angular-busy.html',
        delay: 0,
        minDuration: 100,
        wrapperClass: 'my-class my-class2'
    });
app.factory('RulesApi', ["$resource", function($resource){
    return $resource('/api/v1/rules/:id', {id:'@id'},
        {
            'agree': {
                method:'POST',
                url: "/api/v1/rules/agree"
            },
            'disagree': {
                method: 'POST',
                url: "/api/v1/rules/disagree"
            }
        });
    }]);
app.factory('ServersApi', ["$resource", function($resource){
    return $resource('/api/v1/server/:id', {id:'@id'},
        {
            'update': { method:'PUT' },
            'destroy': {method: 'DELETE'},
            'online': {
                method:'GET',
                url: "/api/v1/server/:id/online"
            }
        });
    }]);
app.factory('UserApi', ["$resource", function($resource){
    return $resource('/api/v1/user/:id', {id:'@id'},
        {
            'update': {method: 'PUT', url: "/api/v1/user/:id/profile"},
            'destroy': {method: 'DELETE'},
            'updateProfile': { method:'PUT' },
            'updatePassword': { method:'PUT' },
            'updateMinecraft': { method:'PUT' },
            'me': {
                method:'GET',
                url: "/api/v1/user/me"
            },
            'meUpdateProfile': {
                method:'PUT',
                url: "/api/v1/user/me/profile"
            },
            'meUpdatePassword': {
                method:'PUT',
                url: "/api/v1/user/me/password"
            },
            'meUpdateMinecraft': {
                method:'PUT',
                url: "/api/v1/user/me/minecraft"
            },
            'patrons': {
                method: 'GET',
                url: "/api/v1/user/patrons"
            },
        });
    }]);
app.controller('ModalInstanceCtrl', ["$scope", "$modalInstance", "ResourcesApi", "recordID", function ($scope, $modalInstance, ResourcesApi, recordID) {

    if (recordID) {
        $scope.myPromise =  ResourcesApi.get({id:recordID}, function(data) {
            $scope.resource = data.data;
            $scope.showModalContent = true;
        });
    }
    else {
        $scope.showModalContent = true;
    }

    $scope.ok = function () {
        if(recordID){
            ResourcesApi.update({ id:$scope.resource.id }, $scope.resource, function(res) {
                $modalInstance.close($scope.resource);
            }, function(res) {
                $scope.errorResponse = res.data.error.message;
            });
        } else {
            console.log("2");
            ResourcesApi.save( $scope.resource, function(res) {
                $modalInstance.close($scope.resource);
            }, function(res) {
                $scope.errorResponse = res.data.error.message;
            });
        }

    };

    $scope.cancel = function () {
        $modalInstance.dismiss('cancel');
    };
}]);
app.controller("AdminCtrl", ["$scope", function($scope) {

    $scope.tabData   = [
        {
            heading: 'Servers',
            route:   'servers'
        },
        {
            heading: 'Patrons',
            route: 'patrons'
        },
        {
            heading: 'Users',
            route:   'users'
        }
    ];


}]).config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {
    //
    // Now set up the states
    $stateProvider.state('servers', {
        url: '/servers',
        templateUrl: '/partials/admin/servers.html',
        controller: 'ServerIndexCtrl'
    })
        .state('servers.detail', {
            url: "^/servers/:id",
            views: {
                '@': {
                    templateUrl: '/partials/admin/servers.detail.html',
                    controller: 'ServerDetailCtrl'
                }
            }})
        .state('patrons', {
            url: '/patrons',
            templateUrl: '/partials/admin/patrons.html',
            controller: 'PatronIndexCtrl'
    })
        .state('users', {
        url: '/users',
            templateUrl: '/partials/admin/users.html',
            controller: 'UserIndexCtrl'
    });

}]);
app.controller("PatronIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function ($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.patrons(function (data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

}]);
app.controller("ServerIndexCtrl", ["$scope", "$modal", "$filter", "ServersApi", function($scope, $modal, $filter, ServersApi) {

    var refreshData = function () {
        $scope.myPromise = ServersApi.get(function(data) {
            $scope.servers = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.$watch('servers', function(newValue, oldValue) {
        angular.forEach($scope.servers, function(server){
            ServersApi.online({id:server.id},function(data) {
                server.online = data.data;
            });

        });

    });

    $scope.open = function (serverEditID) {
        var modalInstance = $modal.open({
            templateUrl: 'AddServerModal.html',
            controller: 'ModalInstanceCtrl',
            resolve: {
                ResourcesApi: function () {
                    return  ServersApi;
                },
                recordID: function () {
                    return  serverEditID;
                }
            }
        });

        modalInstance.result.then(function (data) {
            refreshData();
        }, function () {
        });
    };

}]);
app.controller("ServerDetailCtrl", ["$scope", "$state", "$stateParams", "$filter", "ServersApi", function($scope, $state, $stateParams, $filter, ServersApi) {

    $scope.myPromise =  ServersApi.get({id:$stateParams.id}, function(data) {
        $scope.resource = data.data;

        ServersApi.online({id: $scope.resource.id}, function (data) {
            $scope.resource.online = data.data;
        });
    });


    $scope.destroy = function () {
        ServersApi.destroy({id: $scope.resource.id}, function (data) {
        });

    };



}]);
app.controller("UserIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function ($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.get(function (data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.open = function (UserEditID) {
        var modalInstance = $modal.open({
            templateUrl: 'AddUserModal.html',
            controller: 'ModalInstanceCtrl',
            resolve: {
                ResourcesApi: function () {
                    return UserApi;
                },
                recordID: function () {
                    return UserEditID;
                }
            }
        });

        modalInstance.result.then(function (data) {
            refreshData();
        }, function () {
        });
    };

}]);
app.controller("DashboardCtrl", ["$scope", "$modal", "$filter", "ServersApi", function ($scope, $modal, $filter, ServersApi) {


    var refreshData = function () {
        $scope.myPromise = ServersApi.get(function (data) {
            $scope.servers = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.$watch('servers', function (newValue, oldValue) {
        angular.forEach($scope.servers, function (server) {
            ServersApi.online({id: server.id}, function (data) {
                server.online = data.data;
            });

        });

    });


}]);
app.controller("RulesCtrl", ["$scope", "$modal", "$filter", "RulesApi", function ($scope, $modal, $filter, RulesApi) {


    var refreshData = function () {
        $scope.myPromise = RulesApi.get(function (data) {
            $scope.user = data.data;
        });
    };
    refreshData();


    $scope.changeRules = function() {

        if ($scope.user.rules_agreed){
            RulesApi.agree($scope.resource, function(res) {
            }, function(res) {
            });
        } else {
            RulesApi.disagree($scope.resource, function(res) {
            }, function(res) {
            });
        }

    };


}]);
app.controller("MinecraftIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.me(function(data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.saveMinecraft = function () {
        UserApi.meUpdateMinecraft($scope.resource, function(res) {
            $scope.successMinecraftResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };


}]);
app.controller("ProfileCtrl", ["$scope", function($scope) {

    $scope.tabData   = [
        {
            heading: 'Profile',
            route:   'profile'
        },
        {
            heading: 'Minecraft',
            route:   'minecraft'
        }
    ];


}]).config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {
    //
    // For any unmatched url, redirect to /state1
    $urlRouterProvider.otherwise("/profile");
    //
    // Now set up the states
    $stateProvider.state('profile', {
        url: '/profile',
        templateUrl: '/partials/profile/profile.html'
    }).state('minecraft', {
        url: '/minecraft',
        templateUrl: '/partials/profile/minecraft.html'
    });

}]);
app.controller("ProfileIndexCtrl", ["$scope", "$modal", "$filter", "UserApi", function($scope, $modal, $filter, UserApi) {

    var refreshData = function () {
        $scope.myPromise = UserApi.me(function(data) {
            $scope.resource = data.data;
            $scope.showTableContent = true;
        });
    };
    refreshData();

    $scope.saveProfile = function () {
        UserApi.meUpdateProfile($scope.resource, function(res) {
            $scope.successProfileResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };

    $scope.savePassword = function () {
        UserApi.meUpdatePassword($scope.resource, function(res) {
            $scope.successPasswordResponse = res;
            $scope.errorResponse = null;
        }, function(res) {
            $scope.errorResponse = res.data.error.message;
        });
    };


}]);
app.controller('NavbarInstanceCtrl', ["$scope", function ($scope) {
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIlNlcnZpY2VzL1J1bGVzU2VydmljZS5qcyIsIlNlcnZpY2VzL1NlcnZlclNlcnZpY2UuanMiLCJTZXJ2aWNlcy9Vc2VyU2VydmljZS5qcyIsIkNvbnRyb2xsZXJzL0NvbW1vbi9Nb2RhbHNDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvQWRtaW5pc3RyYXRpb24vQWRtaW5pc3RyYXRpb25Db250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvQWRtaW5pc3RyYXRpb24vUGF0cm9uQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0FkbWluaXN0cmF0aW9uL1NlcnZlckNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9BZG1pbmlzdHJhdGlvbi9TZXJ2ZXJEZXRhaWxDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvQWRtaW5pc3RyYXRpb24vVXNlckNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9EYXNoYm9hcmQvRGFzaGJvYXJkQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1BhZ2VzL1J1bGVzQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1Byb2ZpbGUvTWluZWNyYWZ0SW5kZXhDdHJsLmpzIiwiQ29udHJvbGxlcnMvUHJvZmlsZS9Qcm9maWxlQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1Byb2ZpbGUvUHJvZmlsZUluZGV4Q3RybC5qcyIsIkNvbnRyb2xsZXJzL1JlZ2lvbnMvTmF2YmFyQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0JBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbWNVQVAnLCBbXG4gICAgJ25nUmVzb3VyY2UnLFxuICAgICd1aS5ib290c3RyYXAnLFxuICAgICd1aS5yb3V0ZXIudGFicycsXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgJ2NnQnVzeSdcbiAgICBdKVxuXG5cbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkaW50ZXJwb2xhdGVQcm92aWRlcikge1xuICAgICAgICAkaW50ZXJwb2xhdGVQcm92aWRlci5zdGFydFN5bWJvbCgnW1snKTtcbiAgICAgICAgJGludGVycG9sYXRlUHJvdmlkZXIuZW5kU3ltYm9sKCddXScpO1xuICAgIH0pXG4gICAgLnZhbHVlKCdjZ0J1c3lEZWZhdWx0cycse1xuICAgICAgICBtZXNzYWdlOidMb2FkaW5nIERhdGEnLFxuICAgICAgICBiYWNrZHJvcDogZmFsc2UsXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2NvbW1vbi9hbmd1bGFyLWJ1c3kuaHRtbCcsXG4gICAgICAgIGRlbGF5OiAwLFxuICAgICAgICBtaW5EdXJhdGlvbjogMTAwLFxuICAgICAgICB3cmFwcGVyQ2xhc3M6ICdteS1jbGFzcyBteS1jbGFzczInXG4gICAgfSk7IiwiYXBwLmZhY3RvcnkoJ1J1bGVzQXBpJywgZnVuY3Rpb24oJHJlc291cmNlKXtcbiAgICByZXR1cm4gJHJlc291cmNlKCcvYXBpL3YxL3J1bGVzLzppZCcsIHtpZDonQGlkJ30sXG4gICAgICAgIHtcbiAgICAgICAgICAgICdhZ3JlZSc6IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLFxuICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxL3J1bGVzL2FncmVlXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnZGlzYWdyZWUnOiB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEvcnVsZXMvZGlzYWdyZWVcIlxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTsiLCJhcHAuZmFjdG9yeSgnU2VydmVyc0FwaScsIGZ1bmN0aW9uKCRyZXNvdXJjZSl7XG4gICAgcmV0dXJuICRyZXNvdXJjZSgnL2FwaS92MS9zZXJ2ZXIvOmlkJywge2lkOidAaWQnfSxcbiAgICAgICAge1xuICAgICAgICAgICAgJ3VwZGF0ZSc6IHsgbWV0aG9kOidQVVQnIH0sXG4gICAgICAgICAgICAnZGVzdHJveSc6IHttZXRob2Q6ICdERUxFVEUnfSxcbiAgICAgICAgICAgICdvbmxpbmUnOiB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOidHRVQnLFxuICAgICAgICAgICAgICAgIHVybDogXCIvYXBpL3YxL3NlcnZlci86aWQvb25saW5lXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7IiwiYXBwLmZhY3RvcnkoJ1VzZXJBcGknLCBmdW5jdGlvbigkcmVzb3VyY2Upe1xuICAgIHJldHVybiAkcmVzb3VyY2UoJy9hcGkvdjEvdXNlci86aWQnLCB7aWQ6J0BpZCd9LFxuICAgICAgICB7XG4gICAgICAgICAgICAndXBkYXRlJzoge21ldGhvZDogJ1BVVCcsIHVybDogXCIvYXBpL3YxL3VzZXIvOmlkL3Byb2ZpbGVcIn0sXG4gICAgICAgICAgICAnZGVzdHJveSc6IHttZXRob2Q6ICdERUxFVEUnfSxcbiAgICAgICAgICAgICd1cGRhdGVQcm9maWxlJzogeyBtZXRob2Q6J1BVVCcgfSxcbiAgICAgICAgICAgICd1cGRhdGVQYXNzd29yZCc6IHsgbWV0aG9kOidQVVQnIH0sXG4gICAgICAgICAgICAndXBkYXRlTWluZWNyYWZ0JzogeyBtZXRob2Q6J1BVVCcgfSxcbiAgICAgICAgICAgICdtZSc6IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6J0dFVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEvdXNlci9tZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ21lVXBkYXRlUHJvZmlsZSc6IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BVVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEvdXNlci9tZS9wcm9maWxlXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnbWVVcGRhdGVQYXNzd29yZCc6IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6J1BVVCcsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9hcGkvdjEvdXNlci9tZS9wYXNzd29yZFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ21lVXBkYXRlTWluZWNyYWZ0Jzoge1xuICAgICAgICAgICAgICAgIG1ldGhvZDonUFVUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS92MS91c2VyL21lL21pbmVjcmFmdFwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3BhdHJvbnMnOiB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICB1cmw6IFwiL2FwaS92MS91c2VyL3BhdHJvbnNcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfSk7IiwiYXBwLmNvbnRyb2xsZXIoJ01vZGFsSW5zdGFuY2VDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIFJlc291cmNlc0FwaSwgcmVjb3JkSUQpIHtcblxuICAgIGlmIChyZWNvcmRJRCkge1xuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gIFJlc291cmNlc0FwaS5nZXQoe2lkOnJlY29yZElEfSwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnJlc291cmNlID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnNob3dNb2RhbENvbnRlbnQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgICRzY29wZS5zaG93TW9kYWxDb250ZW50ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHJlY29yZElEKXtcbiAgICAgICAgICAgIFJlc291cmNlc0FwaS51cGRhdGUoeyBpZDokc2NvcGUucmVzb3VyY2UuaWQgfSwgJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUucmVzb3VyY2UpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIjJcIik7XG4gICAgICAgICAgICBSZXNvdXJjZXNBcGkuc2F2ZSggJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgkc2NvcGUucmVzb3VyY2UpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICB9O1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJBZG1pbkN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlKSB7XG5cbiAgICAkc2NvcGUudGFiRGF0YSAgID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICBoZWFkaW5nOiAnU2VydmVycycsXG4gICAgICAgICAgICByb3V0ZTogICAnc2VydmVycydcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgaGVhZGluZzogJ1BhdHJvbnMnLFxuICAgICAgICAgICAgcm91dGU6ICdwYXRyb25zJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBoZWFkaW5nOiAnVXNlcnMnLFxuICAgICAgICAgICAgcm91dGU6ICAgJ3VzZXJzJ1xuICAgICAgICB9XG4gICAgXTtcblxuXG59KS5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgIC8vXG4gICAgLy8gTm93IHNldCB1cCB0aGUgc3RhdGVzXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3NlcnZlcnMnLCB7XG4gICAgICAgIHVybDogJy9zZXJ2ZXJzJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vc2VydmVycy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1NlcnZlckluZGV4Q3RybCdcbiAgICB9KVxuICAgICAgICAuc3RhdGUoJ3NlcnZlcnMuZGV0YWlsJywge1xuICAgICAgICAgICAgdXJsOiBcIl4vc2VydmVycy86aWRcIixcbiAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgJ0AnOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3NlcnZlcnMuZGV0YWlsLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VydmVyRGV0YWlsQ3RybCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9fSlcbiAgICAgICAgLnN0YXRlKCdwYXRyb25zJywge1xuICAgICAgICAgICAgdXJsOiAnL3BhdHJvbnMnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvYWRtaW4vcGF0cm9ucy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQYXRyb25JbmRleEN0cmwnXG4gICAgfSlcbiAgICAgICAgLnN0YXRlKCd1c2VycycsIHtcbiAgICAgICAgdXJsOiAnL3VzZXJzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2FkbWluL3VzZXJzLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJJbmRleEN0cmwnXG4gICAgfSk7XG5cbn0pOyIsImFwcC5jb250cm9sbGVyKFwiUGF0cm9uSW5kZXhDdHJsXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgJGZpbHRlciwgVXNlckFwaSkge1xuXG4gICAgdmFyIHJlZnJlc2hEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gVXNlckFwaS5wYXRyb25zKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUucmVzb3VyY2UgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAkc2NvcGUuc2hvd1RhYmxlQ29udGVudCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmVmcmVzaERhdGEoKTtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJTZXJ2ZXJJbmRleEN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWwsICRmaWx0ZXIsIFNlcnZlcnNBcGkpIHtcblxuICAgIHZhciByZWZyZXNoRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLm15UHJvbWlzZSA9IFNlcnZlcnNBcGkuZ2V0KGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5zZXJ2ZXJzID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnNob3dUYWJsZUNvbnRlbnQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJlZnJlc2hEYXRhKCk7XG5cbiAgICAkc2NvcGUuJHdhdGNoKCdzZXJ2ZXJzJywgZnVuY3Rpb24obmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuc2VydmVycywgZnVuY3Rpb24oc2VydmVyKXtcbiAgICAgICAgICAgIFNlcnZlcnNBcGkub25saW5lKHtpZDpzZXJ2ZXIuaWR9LGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzZXJ2ZXIub25saW5lID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgICRzY29wZS5vcGVuID0gZnVuY3Rpb24gKHNlcnZlckVkaXRJRCkge1xuICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnQWRkU2VydmVyTW9kYWwuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTW9kYWxJbnN0YW5jZUN0cmwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgIFJlc291cmNlc0FwaTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIFNlcnZlcnNBcGk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZWNvcmRJRDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHNlcnZlckVkaXRJRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJlZnJlc2hEYXRhKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSk7XG4gICAgfTtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJTZXJ2ZXJEZXRhaWxDdHJsXCIsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkc3RhdGVQYXJhbXMsICRmaWx0ZXIsIFNlcnZlcnNBcGkpIHtcblxuICAgICRzY29wZS5teVByb21pc2UgPSAgU2VydmVyc0FwaS5nZXQoe2lkOiRzdGF0ZVBhcmFtcy5pZH0sIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgJHNjb3BlLnJlc291cmNlID0gZGF0YS5kYXRhO1xuXG4gICAgICAgIFNlcnZlcnNBcGkub25saW5lKHtpZDogJHNjb3BlLnJlc291cmNlLmlkfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXNvdXJjZS5vbmxpbmUgPSBkYXRhLmRhdGE7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG5cbiAgICAkc2NvcGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgU2VydmVyc0FwaS5kZXN0cm95KHtpZDogJHNjb3BlLnJlc291cmNlLmlkfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJVc2VySW5kZXhDdHJsXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgJGZpbHRlciwgVXNlckFwaSkge1xuXG4gICAgdmFyIHJlZnJlc2hEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gVXNlckFwaS5nZXQoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXNvdXJjZSA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zaG93VGFibGVDb250ZW50ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZWZyZXNoRGF0YSgpO1xuXG4gICAgJHNjb3BlLm9wZW4gPSBmdW5jdGlvbiAoVXNlckVkaXRJRCkge1xuICAgICAgICB2YXIgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnQWRkVXNlck1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICBSZXNvdXJjZXNBcGk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJBcGk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICByZWNvcmRJRDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gVXNlckVkaXRJRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1vZGFsSW5zdGFuY2UucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJlZnJlc2hEYXRhKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfSk7XG4gICAgfTtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJEYXNoYm9hcmRDdHJsXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgJGZpbHRlciwgU2VydmVyc0FwaSkge1xuXG5cbiAgICB2YXIgcmVmcmVzaERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5teVByb21pc2UgPSBTZXJ2ZXJzQXBpLmdldChmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnNlcnZlcnMgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICAkc2NvcGUuc2hvd1RhYmxlQ29udGVudCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmVmcmVzaERhdGEoKTtcblxuICAgICRzY29wZS4kd2F0Y2goJ3NlcnZlcnMnLCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuc2VydmVycywgZnVuY3Rpb24gKHNlcnZlcikge1xuICAgICAgICAgICAgU2VydmVyc0FwaS5vbmxpbmUoe2lkOiBzZXJ2ZXIuaWR9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHNlcnZlci5vbmxpbmUgPSBkYXRhLmRhdGE7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9KTtcblxuICAgIH0pO1xuXG5cbn0pOyIsImFwcC5jb250cm9sbGVyKFwiUnVsZXNDdHJsXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgJGZpbHRlciwgUnVsZXNBcGkpIHtcblxuXG4gICAgdmFyIHJlZnJlc2hEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUubXlQcm9taXNlID0gUnVsZXNBcGkuZ2V0KGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUudXNlciA9IGRhdGEuZGF0YTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZWZyZXNoRGF0YSgpO1xuXG5cbiAgICAkc2NvcGUuY2hhbmdlUnVsZXMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICBpZiAoJHNjb3BlLnVzZXIucnVsZXNfYWdyZWVkKXtcbiAgICAgICAgICAgIFJ1bGVzQXBpLmFncmVlKCRzY29wZS5yZXNvdXJjZSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgUnVsZXNBcGkuZGlzYWdyZWUoJHNjb3BlLnJlc291cmNlLCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH07XG5cblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJNaW5lY3JhZnRJbmRleEN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWwsICRmaWx0ZXIsIFVzZXJBcGkpIHtcblxuICAgIHZhciByZWZyZXNoRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJHNjb3BlLm15UHJvbWlzZSA9IFVzZXJBcGkubWUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLnJlc291cmNlID0gZGF0YS5kYXRhO1xuICAgICAgICAgICAgJHNjb3BlLnNob3dUYWJsZUNvbnRlbnQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJlZnJlc2hEYXRhKCk7XG5cbiAgICAkc2NvcGUuc2F2ZU1pbmVjcmFmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgVXNlckFwaS5tZVVwZGF0ZU1pbmVjcmFmdCgkc2NvcGUucmVzb3VyY2UsIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NNaW5lY3JhZnRSZXNwb25zZSA9IHJlcztcbiAgICAgICAgICAgICRzY29wZS5lcnJvclJlc3BvbnNlID0gbnVsbDtcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JSZXNwb25zZSA9IHJlcy5kYXRhLmVycm9yLm1lc3NhZ2U7XG4gICAgICAgIH0pO1xuICAgIH07XG5cblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJQcm9maWxlQ3RybFwiLCBmdW5jdGlvbigkc2NvcGUpIHtcblxuICAgICRzY29wZS50YWJEYXRhICAgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIGhlYWRpbmc6ICdQcm9maWxlJyxcbiAgICAgICAgICAgIHJvdXRlOiAgICdwcm9maWxlJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBoZWFkaW5nOiAnTWluZWNyYWZ0JyxcbiAgICAgICAgICAgIHJvdXRlOiAgICdtaW5lY3JhZnQnXG4gICAgICAgIH1cbiAgICBdO1xuXG5cbn0pLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgLy9cbiAgICAvLyBGb3IgYW55IHVubWF0Y2hlZCB1cmwsIHJlZGlyZWN0IHRvIC9zdGF0ZTFcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL3Byb2ZpbGVcIik7XG4gICAgLy9cbiAgICAvLyBOb3cgc2V0IHVwIHRoZSBzdGF0ZXNcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgncHJvZmlsZScsIHtcbiAgICAgICAgdXJsOiAnL3Byb2ZpbGUnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9wcm9maWxlL3Byb2ZpbGUuaHRtbCdcbiAgICB9KS5zdGF0ZSgnbWluZWNyYWZ0Jywge1xuICAgICAgICB1cmw6ICcvbWluZWNyYWZ0JyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvcHJvZmlsZS9taW5lY3JhZnQuaHRtbCdcbiAgICB9KTtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoXCJQcm9maWxlSW5kZXhDdHJsXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkZmlsdGVyLCBVc2VyQXBpKSB7XG5cbiAgICB2YXIgcmVmcmVzaERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRzY29wZS5teVByb21pc2UgPSBVc2VyQXBpLm1lKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5yZXNvdXJjZSA9IGRhdGEuZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zaG93VGFibGVDb250ZW50ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZWZyZXNoRGF0YSgpO1xuXG4gICAgJHNjb3BlLnNhdmVQcm9maWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBVc2VyQXBpLm1lVXBkYXRlUHJvZmlsZSgkc2NvcGUucmVzb3VyY2UsIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NQcm9maWxlUmVzcG9uc2UgPSByZXM7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JSZXNwb25zZSA9IG51bGw7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLnNhdmVQYXNzd29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgVXNlckFwaS5tZVVwZGF0ZVBhc3N3b3JkKCRzY29wZS5yZXNvdXJjZSwgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc1Bhc3N3b3JkUmVzcG9uc2UgPSByZXM7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JSZXNwb25zZSA9IG51bGw7XG4gICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgJHNjb3BlLmVycm9yUmVzcG9uc2UgPSByZXMuZGF0YS5lcnJvci5tZXNzYWdlO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbn0pOyIsImFwcC5jb250cm9sbGVyKCdOYXZiYXJJbnN0YW5jZUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=